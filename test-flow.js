/**
 * –¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Å–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
 * –°–∏–º—É–ª–∏—Ä—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–æ—Ä–º—ã, –º—É–ª—å—Ç–∏–∞–≥–µ–Ω—Ç–Ω—ã–π –¥–∏–∞–ª–æ–≥, –¥–∏–∞–ª–æ–≥ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –ø—Ä–æ—Ü–µ—Å—Å–∞
 */

const API_BASE = 'http://localhost:3000';

// –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
const businessData = {
  productDescription: 'SaaS –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞–º–∏ —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏ —Ç—Ä–µ–∫–∏–Ω–≥–∞ –≤—Ä–µ–º–µ–Ω–∏, –∫–æ–ª–ª–∞–±–æ—Ä–∞—Ü–∏–∏ –∏ –æ—Ç—á—ë—Ç–Ω–æ—Å—Ç–∏',
  teamSize: 25,
  workflows: '–ü—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –ª–∏–¥–æ–≤, –ø—Ä–æ–¥–∞–∂–∏, –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ –∫–ª–∏–µ–Ω—Ç–æ–≤, —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞, –ø—Ä–æ–¥–ª–µ–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–æ–≤',
  kpis: 'MRR, Churn Rate, Customer Lifetime Value, Conversion Rate, Time to Resolution'
};

async function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

async function testAPI(endpoint, method = 'GET', body = null) {
  try {
    const options = {
      method,
      headers: { 'Content-Type': 'application/json' },
    };
    if (body) {
      options.body = JSON.stringify(body);
    }
    
    const response = await fetch(`${API_BASE}${endpoint}`, options);
    const data = await response.json();
    
    if (!response.ok) {
      console.error(`‚ùå –û—à–∏–±–∫–∞ ${endpoint}:`, data);
      return null;
    }
    
    return data;
  } catch (error) {
    console.error(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ ${endpoint}:`, error.message);
    return null;
  }
}

async function testFlow() {
  console.log('üöÄ –ù–∞—á–∏–Ω–∞–µ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞...\n');
  
  // –®–∞–≥ 1: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º—É–ª—å—Ç–∏–∞–≥–µ–Ω—Ç–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
  console.log('üìã –®–∞–≥ 1: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º—É–ª—å—Ç–∏–∞–≥–µ–Ω—Ç–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã...');
  let multiAgentState = await testAPI('/api/multi-agent', 'POST', {
    businessData
  });
  
  if (!multiAgentState || !multiAgentState.multiAgentState) {
    console.error('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –º—É–ª—å—Ç–∏–∞–≥–µ–Ω—Ç–Ω—É—é —Å–∏—Å—Ç–µ–º—É');
    return;
  }
  
  console.log('‚úÖ –ú—É–ª—å—Ç–∏–∞–≥–µ–Ω—Ç–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
  console.log(`   –§–∞–∑–∞: ${multiAgentState.multiAgentState.phase}`);
  console.log(`   –°–æ–æ–±—â–µ–Ω–∏–π –∞–≥–µ–Ω—Ç–æ–≤: ${multiAgentState.multiAgentState.agentMessages.length}\n`);
  
  // –®–∞–≥ 2: –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ –≤ –º—É–ª—å—Ç–∏–∞–≥–µ–Ω—Ç–Ω—É—é —Å–∏—Å—Ç–µ–º—É
  console.log('üí¨ –®–∞–≥ 2: –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ –≤ –º—É–ª—å—Ç–∏–∞–≥–µ–Ω—Ç–Ω—É—é —Å–∏—Å—Ç–µ–º—É...');
  
  const answers = [
    '–ù–∞—à–∞ —Ü–µ–ø–æ—á–∫–∞ —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –≤–∫–ª—é—á–∞–µ—Ç: –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥, –ø—Ä–æ–¥–∞–∂–∏ —á–µ—Ä–µ–∑ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤, –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ –Ω–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é –ø–æ–¥–¥–µ—Ä–∂–∫—É –∏ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–æ–≤',
    '–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã: –¥–æ–ª–≥–∏–π —Ü–∏–∫–ª –ø—Ä–æ–¥–∞–∂ (7-14 –¥–Ω–µ–π), –≤—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤, —Ä—É—á–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞',
    '–î–∞, –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º CRM —Å–∏—Å—Ç–µ–º—É, –Ω–æ –æ–Ω–∞ –Ω–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ —Å –¥—Ä—É–≥–∏–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏'
  ];
  
  let currentState = multiAgentState.multiAgentState;
  
  for (let i = 0; i < answers.length; i++) {
    console.log(`   –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞ ${i + 1}/${answers.length}...`);
    const result = await testAPI('/api/multi-agent', 'POST', {
      businessData,
      userMessage: answers[i],
      multiAgentState: currentState
    });
    
    if (result && result.multiAgentState) {
      currentState = result.multiAgentState;
      console.log(`   ‚úÖ –û—Ç–≤–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω. –§–∞–∑–∞: ${currentState.phase}`);
      
      if (result.bottlenecks && result.bottlenecks.length > 0) {
        console.log(`   üéØ –ù–∞–π–¥–µ–Ω–æ —É–∑–∫–∏—Ö –º–µ—Å—Ç: ${result.bottlenecks.length}`);
        result.bottlenecks.forEach((b, idx) => {
          console.log(`      ${idx + 1}. ${b.title}`);
        });
      }
      
      await sleep(1000); // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
    }
  }
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∑–∫–∏–µ –º–µ—Å—Ç–∞
  if (!currentState.bottlenecks || currentState.bottlenecks.length === 0) {
    console.log('\n‚ö†Ô∏è  –£–∑–∫–∏–µ –º–µ—Å—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ç–µ—Å—Ç–æ–≤—ã–º —É–∑–∫–∏–º –º–µ—Å—Ç–æ–º...');
    
    // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤–æ–µ —É–∑–∫–æ–µ –º–µ—Å—Ç–æ
    const testBottleneck = {
      id: 'test_bottleneck_1',
      title: '–ó–∞–¥–µ—Ä–∂–∫–∏ –≤ —Ä–∞–±–æ—Ç–µ —Å –∫–ª–∏–µ–Ω—Ç–æ–º –∏ –∑–∞–∫–ª—é—á–µ–Ω–∏–∏ –¥–æ–≥–æ–≤–æ—Ä–∞',
      processArea: '–†–∞–±–æ—Ç–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º –∏ –∑–∞–∫–ª—é—á–µ–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–∞',
      problemDescription: '–ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã —Å –∫–ª–∏–µ–Ω—Ç–æ–º –∏ –∑–∞–∫–ª—é—á–µ–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞ –∑–∞–Ω–∏–º–∞–µ—Ç –æ—Ç 7 –¥–æ 14 –¥–Ω–µ–π',
      currentImpact: '–£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ü–∏–∫–ª–∞ –ø—Ä–æ–¥–∞–∂, –ø–æ—Ç–µ—Ä—è –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤',
      priority: 'high',
      potentialGain: '–£—Å–∫–æ—Ä–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ø—Ä–æ–¥–∞–∂, —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤',
      asIsProcess: '–ú–µ–Ω–µ–¥–∂–µ—Ä –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É–µ—Ç —Å –∫–ª–∏–µ–Ω—Ç–æ–º, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ–¥—É–∫—Ç–µ',
      toBeProcess: '–í–Ω–µ–¥—Ä–µ–Ω–∏–µ CRM —Å–∏—Å—Ç–µ–º—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏',
      suggestedAgents: ['CRM —Å–∏—Å—Ç–µ–º–∞', '–¢—Ä–µ–Ω–∏–Ω–≥–∏ –ø–æ –ø—Ä–æ–¥–∞–∂–∞–º'],
      mcpToolsNeeded: ['Salesforce', 'Pipedrive']
    };
    
    currentState.bottlenecks = [testBottleneck];
  }
  
  const bottleneck = currentState.bottlenecks[0];
  console.log(`\nüìå –†–∞–±–æ—Ç–∞–µ–º —Å —É–∑–∫–∏–º –º–µ—Å—Ç–æ–º: "${bottleneck.title}"\n`);
  
  // –®–∞–≥ 3: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∏–∞–ª–æ–≥–∞ –ø–æ —É–∑–∫–æ–º—É –º–µ—Å—Ç—É
  console.log('üí¨ –®–∞–≥ 3: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∏–∞–ª–æ–≥–∞ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –ø—Ä–æ—Ü–µ—Å—Å–∞...');
  const initDialog = await testAPI('/api/chat/init', 'POST', {
    businessData,
    bottleneck
  });
  
  if (!initDialog || !initDialog.dialogState) {
    console.error('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∏–∞–ª–æ–≥');
    return;
  }
  
  console.log('‚úÖ –î–∏–∞–ª–æ–≥ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
  console.log(`   –§–∞–∑–∞: ${initDialog.dialogState.phase}`);
  console.log(`   –ü–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ: ${initDialog.dialogState.messages[0].content.substring(0, 100)}...\n`);
  
  // –®–∞–≥ 4: –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –¥–∏–∞–ª–æ–≥
  console.log('üí¨ –®–∞–≥ 4: –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –¥–∏–∞–ª–æ–≥...');
  
  const dialogMessages = [
    '–°–µ–π—á–∞—Å –ø—Ä–æ—Ü–µ—Å—Å –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫: –º–µ–Ω–µ–¥–∂–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç –ª–∏–¥, —Å–≤—è–∑—ã–≤–∞–µ—Ç—Å—è —Å –∫–ª–∏–µ–Ω—Ç–æ–º, –ø—Ä–æ–≤–æ–¥–∏—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤—Å—Ç—Ä–µ—á, –≥–æ—Ç–æ–≤–∏—Ç –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ, —Å–æ–≥–ª–∞—Å–æ–≤—ã–≤–∞–µ—Ç —É—Å–ª–æ–≤–∏—è, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–æ–≥–æ–≤–æ—Ä –Ω–∞ –ø–æ–¥–ø–∏—Å—å. –í–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–Ω–∏–º–∞–µ—Ç 7-14 –¥–Ω–µ–π.',
    '–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –Ω–∞ —ç—Ç–∞–ø–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è —É—Å–ª–æ–≤–∏–π –∏ –ø–æ–¥–ø–∏—Å–∞–Ω–∏—è –¥–æ–≥–æ–≤–æ—Ä–∞. –ö–ª–∏–µ–Ω—Ç—ã —á–∞—Å—Ç–æ –∑–∞–¥–∞—é—Ç –≤–æ–ø—Ä–æ—Å—ã, —Ç—Ä–µ–±—É—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π, –∏ —ç—Ç–æ –∑–∞–Ω–∏–º–∞–µ—Ç –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.',
    '–î–∞, –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º CRM, –Ω–æ –æ–Ω–∞ –Ω–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å. –ú–µ–Ω–µ–¥–∂–µ—Ä—ã –≤—Ä—É—á–Ω—É—é –∑–∞–ø–æ–ª–Ω—è—é—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç –¥–æ–∫—É–º–µ–Ω—Ç—ã –ø–æ email, –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç —Å—Ç–∞—Ç—É—Å—ã –≤ Excel.',
    '–ò–¥–µ–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å: –∫–ª–∏–µ–Ω—Ç –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ñ–æ—Ä–º—É –Ω–∞ —Å–∞–π—Ç–µ, —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –ª–∏–¥ –≤ CRM, –º–µ–Ω–µ–¥–∂–µ—Ä –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ, –ø—Ä–æ–≤–æ–¥–∏—Ç –æ–¥–Ω—É –≤—Å—Ç—Ä–µ—á—É, —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∏ –¥–æ–≥–æ–≤–æ—Ä, –∫–ª–∏–µ–Ω—Ç –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç –æ–Ω–ª–∞–π–Ω. –í–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å –¥–æ–ª–∂–µ–Ω –∑–∞–Ω–∏–º–∞—Ç—å 2-3 –¥–Ω—è.',
    '–î–∞, —ç—Ç–æ –∑–≤—É—á–∏—Ç —Ö–æ—Ä–æ—à–æ. –î–∞–≤–∞–π—Ç–µ –Ω–∞—á–Ω–µ–º —Å –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ –æ–Ω–ª–∞–π–Ω-–ø–æ–¥–ø–∏—Å–∞–Ω–∏—è.'
  ];
  
  let dialogState = initDialog.dialogState;
  
  for (let i = 0; i < dialogMessages.length; i++) {
    console.log(`   –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è ${i + 1}/${dialogMessages.length}...`);
    const result = await testAPI('/api/chat', 'POST', {
      businessData,
      bottleneck,
      dialogState,
      userMessage: dialogMessages[i]
    });
    
    if (result) {
      dialogState = result.updatedDialogState;
      console.log(`   ‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ. –§–∞–∑–∞: ${dialogState.phase}`);
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–∫–∏
      if (result.updatedBottleneck) {
        console.log(`   üìù –ö–∞—Ä—Ç–æ—á–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞:`, Object.keys(result.updatedBottleneck).join(', '));
      }
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –¥–∏–∞–ª–æ–≥–∞
      if (result.refinedBottleneck) {
        console.log(`   üéâ –î–∏–∞–ª–æ–≥ –∑–∞–≤–µ—Ä—à–µ–Ω!`);
        console.log(`   ‚úÖ –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞: ${result.refinedBottleneck.processDescription ? '–µ—Å—Ç—å' : '–Ω–µ—Ç'}`);
        console.log(`   ‚úÖ –¢–ó: ${result.refinedBottleneck.technicalSpec ? '–µ—Å—Ç—å' : '–Ω–µ—Ç'}`);
      }
      
      await sleep(1500);
    }
  }
  
  // –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
  console.log('\nüìä –ò—Ç–æ–≥–æ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:');
  console.log(`   –§–∞–∑–∞ –¥–∏–∞–ª–æ–≥–∞: ${dialogState.phase}`);
  console.log(`   –°–æ–æ–±—â–µ–Ω–∏–π –≤ –¥–∏–∞–ª–æ–≥–µ: ${dialogState.messages.length}`);
  console.log(`   –ò–Ω—Å–∞–π—Ç–æ–≤ —Å–æ–±—Ä–∞–Ω–æ: ${dialogState.insights.length}`);
  console.log(`   –î–∏–∞–ª–æ–≥ –∑–∞–≤–µ—Ä—à–µ–Ω: ${dialogState.isComplete ? '‚úÖ' : '‚ùå'}`);
  
  if (dialogState.insights.length > 0) {
    console.log('\nüí° –°–æ–±—Ä–∞–Ω–Ω—ã–µ –∏–Ω—Å–∞–π—Ç—ã:');
    dialogState.insights.forEach((insight, idx) => {
      console.log(`   ${idx + 1}. ${insight}`);
    });
  }
  
  console.log('\n‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!');
}

// –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç
testFlow().catch(console.error);

